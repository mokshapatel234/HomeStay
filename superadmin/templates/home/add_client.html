{% extends 'layouts/base.html' %}

{% block title %} Profile {% endblock title %}

{% block content %}


<!-- Page content -->
    <div class="col-xl-12">
      <div class="card">
        <div class="card-header">
          <div class="row align-items-center">
            <div class="col-8">
              <h3 class="mb-0">Client Management </h3>
            </div>
           
          </div>
        </div>
        <div class="card-body">
          <form method="POST" enctype="multipart/form-data">
            {% csrf_token %}
            {% if msg %}
                <p class="text-danger"> *{{msg}} </p>
              {% endif %}
            <h6 class="heading-small text-muted mb-4">User information</h6>
            <div class="pl-lg-4">
                <div class="row">
                 
                </div>
                  <div class="col-lg-6">
                    <div class="form-group">
                      <label class="form-control-label" >First name*</label>
                      <input type="text" class="form-control" placeholder="First name" name="first_name" required>
                    </div>
                  </div>
                  <div class="col-lg-6">
                    <div class="form-group">
                      <label class="form-control-label" >Last name*</label>
                      <input type="text" class="form-control" placeholder="Last name" name="last_name" required>
                    </div>
                  </div>
                  <div class="col-lg-6">
                    <div class="form-group">
                      <label class="form-control-label" >Email address*</label>
                      <input type="email" class="form-control" placeholder="Email" name="email" required>
                    </div>
                  </div>
                  <div class="col-lg-6">
                    <div class="form-group">
                      <label class="form-control-label" >Password*</label>
                      <input type="password" class="form-control" placeholder="Password" name="password" required>
                    </div>
                  </div>
                  <div class="col-lg-6">
                    <div class="form-group">
                      <label class="form-control-label">Profile Image*</label>
                      <input type="file" class="form-control" placeholder="Profile Image" name="profile_image" required>
                    </div>
                  </div>
                  <div class="col-lg-6">
                    <div class="form-group">
                      <label class="form-control-label" >contact_no</label>
                      <input type="number" class="form-control" placeholder="Contact No" pattern="[0-9]{10}" maxlength="10" name="contact_no">
                    </div>
                  </div>
                
              
                  <div class="col-lg-6">
                    <div class="form-group">
                      <label class="form-control-label">State*</label>
                      <select name="state" class="form-control" id="state-dropdown" required>
                        <option value="">Select a state</option>
                        {% for state in states %}
                          <option value="{{ state.id }}">{{ state.name }}</option>
                        {% endfor %}
                      </select>
                    </div>
                  </div>
                  
                  <div class="col-lg-6">
                    <div class="form-group">
                      <label class="form-control-label">City*</label>
                      <select name="city" class="form-control" id="city-dropdown" required disabled>
                        <option value="">Select a city</option>
                        {% for city in cities %}
                        <option value="{{ city.id }}">{{ city.name }}</option>
                      {% endfor %}
                      </select>
                    </div>
                  </div>
                  
                  <div class="col-lg-6">
                    <div class="form-group">
                      <label class="form-control-label">Area*</label>
                      <select name="area" class="form-control" id="area-dropdown" required disabled>
                        <option value="">Select an area</option>
                        {% for area in areas %}
                        <option value="{{ area.id }}">{{ area.name }}</option>
                      {% endfor %}
                      </select>
                    </div>
                  </div>
                </div>
              </div>  

              <div class="text-center">
                <button type="submit" class="btn btn-primary my-4">Submit</button>
              </div>
            </form>
        </div>
      </div>
    </div>
  </div>

 

</div>

{% endblock content %}

<!-- Specific JS goes HERE --> 
{% block javascripts %}
<script>
  // Get references to the dropdowns
  const stateDropdown = document.getElementById('state-dropdown');
  const cityDropdown = document.getElementById('city-dropdown');
  const areaDropdown = document.getElementById('area-dropdown');

  // Enable city dropdown when a state is selected
  stateDropdown.addEventListener('change', function() {
    const stateId = this.value;
    cityDropdown.disabled = stateId === '';
    areaDropdown.disabled = true;

    // Clear previous city and area options
    cityDropdown.innerHTML = '<option value="">Select a city</option>';
    areaDropdown.innerHTML = '<option value="">Select an area</option>';

    if (stateId !== '') {
      // Filter cities based on the selected state
      const filteredCities = cities.filter(city => city.state_id === parseInt(stateId));

      // Add filtered cities to the city dropdown
      filteredCities.forEach(city => {
        const option = document.createElement('option');
        option.value = city.id;
        option.textContent = city.name;
        cityDropdown.appendChild(option);
      });
    }
  });

  // Enable area dropdown when a city is selected
  cityDropdown.addEventListener('change', function() {
    const cityId = this.value;
    areaDropdown.disabled = cityId === '';

    // Clear previous area options
    areaDropdown.innerHTML = '<option value="">Select an area</option>';

    if (cityId !== '') {
      // Filter areas based on the selected city
      const filteredAreas = areas.filter(area => area.city_id === parseInt(cityId));

      // Add filtered areas to the area dropdown
      filteredAreas.forEach(area => {
        const option = document.createElement('option');
        option.value = area.id;
        option.textContent = area.name;
        areaDropdown.appendChild(option);
      });
    }
  });
</script>
{% endblock javascripts %}
